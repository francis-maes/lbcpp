<?xml version="1.0" encoding="UTF-8"?>

<library name="CoreType" directory="Core/Type">
  <include file="lbcpp/Core/Pair.h"/>
  <include file="lbcpp/Core/Vector.h"/>
  
  <type name="Variable" base="" implementation="TopLevelType"/>

  <!-- Object -->
  <class name="Object" base="Variable" abstract="yes">
    <function lang="lua" name="create" static="yes"/>
    <function lang="lua" name="fromFile" static="yes"/>
    <function lang="lua" name="clone"/>
    <function lang="lua" name="toShortString"/>
    <function lang="lua" name="save"/>
  </class>
  
  <class name="NameableObject" base="Object" abstract="yes">
    <variable type="NewString" name="name"/>
  </class>

  <!-- Signature -->
  <class name="Signature" base="NameableObject">
    <variable type="NewString" name="shortName"/>
    <variable type="NewString" name="description"/>
  </class>
  <class name="FunctionSignature" base="Signature">
    <variable type="NewBoolean" name="staticFunction"/>
  </class>
  <class name="LuaFunctionSignature" base="FunctionSignature">
    <!-- variable: lua function -->
  </class>
  <class name="VariableSignature" base="Signature">
    <variable type="Type" name="type"/>
  </class>
  
  <!-- Type -->
  <class name="Type" base="NameableObject" abstract="yes">
    <variable type="Type" name="baseType"/>
    <variable type="TemplateType" name="templateType"/>
    <variable type="ObjectVector[Type]" name="templateArguments"/>
    <variable type="NewString" name="shortName"/>
    <code>
      virtual ObjectPtr createFromString(ExecutionContext&amp; context, const String&amp; value) const
        {return typeManager().getType(context, value);}

      virtual ObjectPtr createFromXml(XmlImporter&amp; importer) const
      {
        String text = importer.getAllSubText().trim();
        if (text.isNotEmpty())
          return createFromString(importer.getContext(), importer.getAllSubText());
        else
          return Type::loadUnnamedTypeFromXml(importer);
      }
    </code>
  </class>

  <class name="Class" base="Type" abstract="yes">
    <code>
      virtual ObjectPtr createFromString(ExecutionContext&amp; context, const String&amp; value) const
        {return Type::createFromString(context, value);}

      virtual ObjectPtr createFromXml(XmlImporter&amp; importer) const
        {return Type::createFromXml(importer);}
    </code>
  </class>

  <class name="EnumerationElement" base="Object">
    <variable type="NewString" name="name"/>
    <variable type="NewString" name="oneLetterCode"/>
    <variable type="NewString" name="shortName"/>
    <variable type="NewString" name="description"/>
  </class>

  <class name="Enumeration" base="Class" abstract="yes">
    <code>
      virtual ObjectPtr createFromString(ExecutionContext&amp; context, const String&amp; value) const
        {return Type::createFromString(context, value);}

      virtual ObjectPtr createFromXml(XmlImporter&amp; importer) const
        {return Type::createFromXml(importer);}
    </code>
  </class>
  
  <class name="DefaultEnumeration" base="Enumeration">
    <variable type="ObjectVector[EnumerationElement]" name="elements"/>
  </class>
  
  <class name="ConcatenateEnumeration" base="Enumeration">
    <variable type="ObjectVector[Pair[NewString,Enumeration]]" name="subEnumerations"/>
  </class>

  <class name="DefaultClass" base="Class">
    <variable type="ObjectVector[VariableSignature]" name="variables"/>
    <variable type="NewBoolean" name="abstractClass"/>
  </class>

  <!-- Template Type -->
  <class name="TemplateType" base="NameableObject" abstract="yes"/>

</library>
