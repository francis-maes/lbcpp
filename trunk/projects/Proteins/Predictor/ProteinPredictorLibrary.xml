<?xml version="1.0" encoding="UTF-8"?>

<library name="ProteinPredictor" directory="Predictor">

  <class name="ProteinPrimaryPerception" base="Object" abstract="yes">
    <variable type="Protein" name="protein"/>
    <variable type="PositiveInteger" name="length"/>
    <variable type="PositiveInteger" name="numCysteins"/>
  </class>

  <template name="NumericalProteinPrimaryFeatures" base="ProteinPrimaryPerception">
    <parameter name="featuresEnumeration"/>
    <parameter name="globalFeaturesEnumeration"/>
    <variable type="Vector[DoubleVector[featuresEnumeration, Double]]" name="primaryResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[featuresEnumeration], Double]]" name="accumulator"/>
    <variable type="DenseDoubleVector[globalFeaturesEnumeration, Double]" name="globalFeatures"/>
  </template>

  <class name="ProteinLengthFunction" base="SimpleUnaryFunction"/>
  <class name="NumCysteinsFunction" base="SimpleUnaryFunction"/>
  
  <class name="CreateProteinPerceptionFunction" base="Function"/>
  <class name="SubtractFunction" base="Function"/>
  <class name="CreateDisulfideSymmetricMatrixFunction" base="Function">
    <variable type="Function" name="elementGeneratorFunction"/>
  </class>
  <class name="CreateDisulfideMatrixFunction" base="Function">
    <variable type="Function" name="elementGeneratorFunction"/>
  </class>
  <class name="CreateCysteinBondingStateVectorFunction" base="Function">
    <variable type="Function" name="elementGeneratorFunction"/>
  </class>
  <class name="CreateCysteinSeparationProfil" base="Function"/>
  <class name="CysteinBondingStateRatio" base="SimpleUnaryFunction"/>

  <class name="GreedyDisulfideBondRatio" base="SimpleUnaryFunction">
    <variable type="PositiveInteger" name="minimumDistanceFromDiagonal"/>
  </class>
  <class name="GreedyDisulfideBondSumOfRow" base="Function">
    <variable type="PositiveInteger" name="minimumDistanceFromDiagonal"/>
  </class>

  <class name="GetDoubleVectorValueFunction" base="FeatureGenerator"/>
  
  <class name="GetSupervisionFunction" base="Function"/>
  
  <class name="SumDoubleVectorFunction" base="Function"/>
  
  <class name="GetPairBondingStateProbabilities" base="FeatureGenerator">
    <variable type="Boolean" name="useSpecialFeatures"/>
  </class>

  <class name="GetBondingStateProbabilities" base="FeatureGenerator">
    <variable type="Boolean" name="useSpecialFeatures"/>
  </class>
  
  <class name="IsNumCysteinPair" base="FeatureGenerator"/>
  
  <class name="ProteinPredictor" base="CompositeFunction">
    <variable type="ProteinPredictorParameters" name="parameters"/>
    <variable type="GenericVector[Pair[VariablesEnumeration[Protein], Function]]" name="targetPredictors"/>
    <variable type="Boolean" name="activeGlobalPerception"/>
    <variable type="Boolean" name="activeResiduePerception"/>
    <varaible type="Boolean" name="activeResiduePairPerception"/>
    <variable type="Boolean" name="activeDisulfideResiduePairPerception"/>
    <variable type="Boolean" name="activeDisulfideSymmetricResiduePairPerception"/>
    <variable type="Boolean" name="activeCysteinResiduePerception"/>
  </class>
  
  <class name="ProteinSequentialPredictor" base="CompositeFunction">
    <variable type="ObjectVector[ProteinPredictor]" name="predictors"/>
  </class>

  <class name="ProteinPredictorParameters" base="Object" abstract="yes"/>

  <class name="NumericalProteinFeaturesParameters" shortName="features">
    <variable type="PositiveInteger" name="pssmDiscretization"/>
    <variable type="PositiveInteger" name="pssmEntropyDiscretization"/>

    <variable type="PositiveInteger" name="ss3Discretization"/>
    <variable type="PositiveInteger" name="ss3EntropyDiscretization"/>

    <variable type="PositiveInteger" name="ss8Discretization"/>
    <variable type="PositiveInteger" name="ss8EntropyDiscretization"/>

    <variable type="PositiveInteger" name="stalDiscretization"/>
    <variable type="PositiveInteger" name="stalEntropyDiscretization"/>

    <variable type="PositiveInteger" name="sa20Discretization"/>
    
    <variable type="PositiveInteger" name="drDiscretization"/>

<!--    <variable type="Boolean" name="residuePairGlobalFeatures" description="Incorporate global mean features"/> -->
    <variable type="PositiveInteger" name="residueWindowSize" description="The size of the residues window"/>
<!--    <variable type="PositiveInteger" name="residueLocalMeanSize" description="The size of the first residue local mean"/> -->
<!--    <variable type="PositiveInteger" name="residueMediumMeanSize" description="The size of the second residue local mean"/> -->
  </class>
  
  <class name="NumericalProteinPredictorParameters" base="ProteinPredictorParameters" shortName="numerical">
    <constructor arguments="NumericalProteinFeaturesParametersPtr featuresParameters, LearnerParametersPtr learningParameters"/>
    <constructor/>
    <variable type="NumericalProteinFeaturesParameters" name="featuresParameters" shortName="f"/>
    <variable type="LearnerParameters" name="learningParameters" shortName="l"/>
  </class>
  
  <class name="NumericalCysteinFeaturesParameters" base="Object" shortName="ncFeatures">
    <variable type="Boolean" name="useAminoAcid"/>
    <variable type="Boolean" name="usePSSM"/>
    <variable type="Boolean" name="useGlobalHistogram"/>
    <variable type="Boolean" name="useNumCysteins"/>
    <variable type="Boolean" name="useDiscretizeNumCysteins"/>
    <variable type="Boolean" name="useCysteinParity"/>
  
    <variable type="PositiveInteger" name="residueWindowSize"/>
    <variable type="PositiveInteger" name="localHistogramSize"/>
    <variable type="PositiveInteger" name="separationProfilSize"/>

    <variable type="Boolean" name="useIntervalHistogram"/>
    
    <variable type="Boolean" name="useAADistance"/>

    <variable type="PositiveInteger" name="pairWindowSize"/>
    <variable type="PositiveInteger" name="normalizedWindowSize"/>
    
    <variable type="Boolean" name="useExtendedD1Feature"/>

    <variable type="PositiveInteger" name="d1WindowSize"/>
    <variable type="Boolean" name="useExtendedD2Feature"/>

    <variable type="Boolean" name="useCysteinPositionDifference"/>
    <variable type="Boolean" name="useCysteinIndexDifference"/>
    <variable type="Boolean" name="useConnectivityPattern"/>
    <variable type="Boolean" name="useCartesianConnectivity"/>
    <variable type="Boolean" name="useConnectivityStats"/>
    
    <variable type="Boolean" name="useCysteinDistance"/>
    <variable type="Boolean" name="useCommonNeighbors"/>
    <variable type="Boolean" name="useJaccardsCoef"/>
    <variable type="Boolean" name="useAdomicAdar"/>
    <variable type="Boolean" name="useAttachement"/>
  </class>
  
  <class name="NumericalCysteinPredictorParameters" base="ProteinPredictorParameters" shortName="numericalCystein">
    <constructor/>
    <variable type="Boolean" name="useAddBiasLearner"/>
    <variable type="NumericalCysteinFeaturesParameters" name="fp"/>
    <variable type="LearnerParameters" name="learningParameters" shortName="l"/>
    <variable type="Boolean" name="useOracleD0"/>
    <variable type="Boolean" name="useOracleD1"/>
    <variable type="Boolean" name="useOracleD2"/>
  </class>
  
  <!-- Connectivity Pattern Classifier -->
  <class name="AddConnectivityPatternBiasBatchLearner" base="BatchLearner">
    <constructor/>
  </class>

  <class name="AddConnectivityPatternBiasLearnableFunction" base="Function">
    <variable type="Double" name="bias"/>
  </class>

  <class name="ConnectivityPatternClassifier" base="CompositeFunction">
    <variable type="Function" name="classifier"/>
    <variable type="Boolean" name="isSymmetricMatrix"/>
  </class>
  
  <!-- BEGIN Article: Lin 2009 -->
  <class name="NormalizedCysteinPositionDifference" base="FeatureGenerator"/>
  <class name="NormalizedCysteinIndexDifference" base="FeatureGenerator"/>
  <class name="CreateLin09ProteinPerception" base="Function"/>

  <template name="Lin09ProteinPerception" base="ProteinPrimaryPerception">
    <parameter name="globalFeaturesEnumeration"/>
    <parameter name="aaFeaturesEnumeration"/>
    <parameter name="pssmFeaturesEnumeration"/>
    <variable type="DenseDoubleVector[globalFeaturesEnumeration, Double]" name="globalFeatures"/>
    <variable type="Vector[DoubleVector[aaFeaturesEnumeration, Double]]" name="aaResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[aaFeaturesEnumeration], Double]]" name="aaAccumulator"/>
    <variable type="Vector[DoubleVector[pssmFeaturesEnumeration, Double]]" name="pssmResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[pssmFeaturesEnumeration], Double]]" name="pssmAccumulator"/>
  </template>
  
  <class name="Lin09Parameters" base="Object">
    <variable type="Boolean" name="useProteinLength"/>
    <variable type="Boolean" name="useAminoAcidGlobalHistogram"/>
    <variable type="Boolean" name="usePSSMGlobalHistogram"/>
    <variable type="Boolean" name="useNumCysteins"/>

    <variable type="PositiveInteger" name="aminoAcidWindowSize"/>
    <variable type="PositiveInteger" name="pssmWindowSize"/>
    <variable type="PositiveInteger" name="separationProfilSize"/>
    <variable type="PositiveInteger" name="aminoAcidLocalHistogramSize"/>
    <variable type="PositiveInteger" name="pssmLocalHistogramSize"/>

    <variable type="Boolean" name="useSymmetricFeature"/>
    <variable type="Boolean" name="useAminoAcidIntervalHistogram"/>
    <variable type="Boolean" name="usePSSMIntervalHistogram"/>
    <variable type="Boolean" name="useAADistance"/>
    <variable type="Boolean" name="useCysteinDistance"/>
    <variable type="Boolean" name="usePositionDifference"/>
    <variable type="Boolean" name="useIndexDifference"/>
  </class>
  
  <class name="Lin09PredictorParameters" base="ProteinPredictorParameters" shortName="lin09">
    <variable type="Lin09Parameters" name="fp"/>
    <variable type="Double" name="C"/>
    <variable type="Double" name="kernelGamma"/>
    <variable type="Boolean" name="useLibSVM"/>
    <variable type="Boolean" name="useLibLinear"/>
    <variable type="Boolean" name="useLaRank"/>
    <variable type="Boolean" name="useKNN"/>
    <variable type="Boolean" name="useExtraTrees"/>
    <variable type="Double" name="learningRate"/>
    <variable type="PositiveInteger" name="numIterations"/>
    <variable type="PositiveInteger" name="numNeighbors"/>
    <variable type="Boolean" name="useAddBias"/>
  </class>
  <!-- END Article: Lin 2009 -->


  <!-- BEGIN GaussianKernel -->
  <class name="DecoratorProteinPredictorParameters" base="ProteinPredictorParameters">
    <variable type="ProteinPredictorParameters" name="decorated"/>
  </class>

  <class name="GaussianKernelFeatureGenerator" base="FeatureGenerator">
    <variable type="Double" name="gamma"/>
    <variable type="GenericVector[DoubleVector[PositiveIntegerEnumeration,Double]]" name="supportVectors"/>
    <variable type="GenericVector[Double]" name="supportNorms"/>
  </class>
  
  <class name="GaussianKernelPredictorParameters" base="DecoratorProteinPredictorParameters">
    <variable type="FeatureGenerator" name="gaussianKernel"/>
  </class>
  <!-- END GaussianKernel -->


  <!-- BEGIN LargePredictorParameters -->
  <template name="LargeProteinPerception" base="ProteinPrimaryPerception">
    <parameter name="globalFeaturesEnumeration"/>
    <parameter name="aaFeaturesEnumeration"/>
    <parameter name="pssmFeaturesEnumeration"/>
    <parameter name="ss3FeaturesEnumeration"/>
    <parameter name="ss8FeaturesEnumeration"/>
    <parameter name="saFeaturesEnumeration"/>
    <parameter name="drFeaturesEnumeration"/>
    <parameter name="stalFeaturesEnumeration"/>

    <variable type="DenseDoubleVector[globalFeaturesEnumeration, Double]" name="globalFeatures"/>

    <variable type="Vector[DoubleVector[aaFeaturesEnumeration, Double]]" name="aaResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[aaFeaturesEnumeration], Double]]" name="aaAccumulator"/>

    <variable type="Vector[DoubleVector[pssmFeaturesEnumeration, Double]]" name="pssmResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[pssmFeaturesEnumeration], Double]]" name="pssmAccumulator"/>

    <variable type="Vector[DoubleVector[ss3FeaturesEnumeration, Double]]" name="ss3ResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[ss3FeaturesEnumeration], Double]]" name="ss3Accumulator"/>

    <variable type="Vector[DoubleVector[ss8FeaturesEnumeration, Double]]" name="ss8ResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[ss8FeaturesEnumeration], Double]]" name="ss8Accumulator"/>

    <variable type="Vector[DoubleVector[saFeaturesEnumeration, Double]]" name="saResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[saFeaturesEnumeration], Double]]" name="saAccumulator"/>

    <variable type="Vector[DoubleVector[drFeaturesEnumeration, Double]]" name="drResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[drFeaturesEnumeration], Double]]" name="drAccumulator"/>

    <variable type="Vector[DoubleVector[stalFeaturesEnumeration, Double]]" name="stalResidueFeatures"/>
    <variable type="Container[DenseDoubleVector[AddMissingToEnumeration[stalFeaturesEnumeration], Double]]" name="stalAccumulator"/>
  </template>

  <class name="LargeProteinParameters" base="Object">
    <!-- Global Features -->
    <variable type="Boolean" name="useProteinLength"/>
    <variable type="Boolean" name="useNumCysteins"/>

    <variable type="Boolean" name="useAminoAcidGlobalHistogram"/>
    <variable type="Boolean" name="usePSSMGlobalHistogram"/>
    <variable type="Boolean" name="useSS3GlobalHistogram"/>
    <variable type="Boolean" name="useSS8GlobalHistogram"/>
    <variable type="Boolean" name="useSAGlobalHistogram"/>
    <variable type="Boolean" name="useDRGlobalHistogram"/>
    <variable type="Boolean" name="useSTALGlobalHistogram"/>
    <!-- Residue Features -->
    <variable type="Boolean" name="useRelativePosition"/>
    <variable type="Boolean" name="useRelativeCysteinIndex"/>

    <variable type="PositiveInteger" name="aminoAcidWindowSize"/>
    <variable type="PositiveInteger" name="pssmWindowSize"/>
    <variable type="PositiveInteger" name="ss3WindowSize"/>
    <variable type="PositiveInteger" name="ss8WindowSize"/>
    <variable type="PositiveInteger" name="saWindowSize"/>
    <variable type="PositiveInteger" name="drWindowSize"/>
    <variable type="PositiveInteger" name="stalWindowSize"/>

    <variable type="PositiveInteger" name="aminoAcidLocalHistogramSize"/>
    <variable type="PositiveInteger" name="pssmLocalHistogramSize"/>
    <variable type="PositiveInteger" name="ss3LocalHistogramSize"/>
    <variable type="PositiveInteger" name="ss8LocalHistogramSize"/>
    <variable type="PositiveInteger" name="saLocalHistogramSize"/>
    <variable type="PositiveInteger" name="drLocalHistogramSize"/>
    <variable type="PositiveInteger" name="stalLocalHistogramSize"/>

    <variable type="PositiveInteger" name="separationProfilSize"/>
    <!-- Residue Pair Features -->
  </class>
  
  <class name="LargeProteinPredictorParameters" base="ProteinPredictorParameters">
    <variable type="LargeProteinParameters" name="fp"/>
    <variable type="Boolean" name="isGlobalFeaturesLazy"/>
    <variable type="String" name="learningMachineName"/>
    <variable type="Double" name="svmC"/>
    <variable type="Double" name="svmGamma"/>
    <variable type="PositiveInteger" name="knnNeighbors"/>
    <variable type="PositiveInteger" name="x3Trees"/>
    <variable type="PositiveInteger" name="x3Attributes"/>
    <variable type="PositiveInteger" name="x3Splits"/>
    <variable type="Double" name="sgdRate"/>
    <variable type="PositiveInteger" name="sgdIterations"/>
    <variable type="Boolean" name="useAddBias"/>
    <variable type="GenericVector[Function]" name="featureGenerators"/>
  </class>
  <!-- END LargePredictorParameters -->
</library>
