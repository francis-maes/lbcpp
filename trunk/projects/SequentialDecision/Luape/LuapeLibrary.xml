<?xml version="1.0" encoding="UTF-8"?>

<library name="Luape" directory="Luape">

  <class name="LuapeNodeCache"/>

  <!-- Nodes -->
  <class name="LuapeNode" base="NameableObject" abstract="yes">
    <variable type="Type" name="type"/>
    <variable type="LuapeNodeCache" name="cache"/>
  </class>
  <class name="LuapeInputNode" base="LuapeNode"/>
  <class name="LuapeFunctionNode" base="LuapeNode">
    <variable type="Function" name="function"/>
    <variable type="GenericVector[PositiveInteger]" name="arguments"/>
  </class>
  <class name="LuapeYieldNode" base="LuapeNode">
    <variable type="PositiveInteger" name="argument"/>
  </class>

  <!-- Graph -->
  <class name="LuapeGraph" base="Object">
    <variable type="ObjectVector[LuapeNode]" name="nodes"/>
    <variable type="PositiveInteger" name="numExamples"/>
    <variable type="LuapeGraphCache" name="cache"/>
  </class>
  <class name="LuapeGraphCache"/>

  <!-- Function -->
  <class name="LuapeFunction" base="Function" abstract="yes">
    <variable type="LuapeGraph" name="graph"/>
    <variable type="Vector[Variable]" name="votes"/>
  </class>
  <class name="LuapeBinaryClassifier" base="LuapeFunction">
    <constructor/>
  </class>
  <class name="LuapeClassifier" base="LuapeFunction">
    <constructor/>
  </class>
  
  <!-- Problem -->
  <class name="LuapeProblem">
    <variable type="ObjectVector[VariableSignature]" name="inputs"/>
    <variable type="ObjectVector[Function]" name="functions"/>
    <variable type="Boolean" name="failed"/>
    <function lang="lua" name="input"/>
    <function lang="lua" name="function"/>
  </class>

  <!-- Builder Decision Problem -->
  <class name="LuapeGraphBuilderState" base="DecisionProblemState">
    <variable type="LuapeProblem" name="problem"/>
    <variable type="LuapeGraph" name="graph"/>
    <variable type="PositiveInteger" name="maxSteps"/>
    <variable type="PositiveInteger" name="numSteps"/>
  </class>

  <class name="LuapeRPNGraphBuilderState" base="DecisionProblemState">
    <variable type="LuapeProblem" name="problem"/>
    <variable type="LuapeGraph" name="graph"/>
    <variable type="PositiveInteger" name="maxSteps"/>
    <variable type="PositiveInteger" name="numSteps"/>
  </class>

  <!-- Weak Learners -->
  <class name="LuapeWeakLearner" base="Object" abstract="yes"/>
  <class name="LuapeGraphBuilderWeakLearner" base="LuapeWeakLearner">
    <constructor arguments="OptimizerPtr optimizer, size_t maxSteps"/>
    <variable type="Optimizer" name="optimizer"/>
    <variable type="PositiveInteger" name="maxSteps"/>
  </class>
  <class name="SingleStumpWeakLearner" base="LuapeWeakLearner">
    <constructor/>
  </class>
  <class name="CombinedStumpWeakLearner" base="LuapeWeakLearner">
    <constructor/>
  </class>
  <class name="ProductWeakLearner" base="LuapeWeakLearner">
    <constructor arguments="LuapeWeakLearnerPtr baseLearner, size_t numBaseClassifiers"/>
    <variable type="LuapeWeakLearner" name="baseLearner"/>
    <variable type="PositiveInteger" name="numBaseClassifiers"/>
  </class>

  <!-- Batch Learners -->
  <class name="LuapeBatchLearner" base="BatchLearner" abstract="yes">
    <variable type="LuapeProblem" name="problem"/>
  </class>
  <class name="BoostingLuapeLearner" base="LuapeBatchLearner" abstract="yes">
    <variable type="LuapeWeakLearner" name="weakLearner"/>
    <variable type="PositiveInteger" name="maxIterations"/>
  </class>
  <class name="AdaBoostLuapeLearner" base="BoostingLuapeLearner">
    <constructor arguments="LuapeProblemPtr problem, LuapeWeakLearnerPtr weakLearner, size_t maxIterations" returnType="BatchLearner"/>
  </class>
  <class name="AdaBoostMHLuapeLearner" base="BoostingLuapeLearner">
    <constructor arguments="LuapeProblemPtr problem, LuapeWeakLearnerPtr weakLearner, size_t maxIterations" returnType="BatchLearner"/>
  </class>
  
  <!-- Sand Box -->
  <class name="ProductFunction" base="Function"/>
  <class name="DivideFunction" base="Function"/>
  <class name="LogFunction" base="Function"/>
  <class name="StumpFunction" base="Function">
    <variable type="Double" name="threshold"/>
  </class>
  <class name="GreaterThanFunction" base="Function"/>
  <class name="BooleanAndFunction" base="Function"/>
  <class name="BooleanXorFunction" base="Function"/>


  <class name="LuapeSandBox" base="WorkUnit">
    <variable type="File" name="trainFile"/>
    <variable type="File" name="testFile"/>
    <variable type="PositiveInteger" name="maxExamples"/>
    <variable type="PositiveInteger" name="maxSteps"/>
    <variable type="PositiveInteger" name="budgetPerIteration"/>
    <variable type="PositiveInteger" name="maxIterations"/>
  </class>
</library>
